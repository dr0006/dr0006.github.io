(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20753],{87170:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/result",function(){return n(35857)}])},58979:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return I},default:function(){return O}});var r=n(85893),o=n(43551),l=n.n(o),a=n(67294),i=()=>{let[e,t]=(0,a.useState)(""),[n,o]=(0,a.useState)(!1),l=()=>{o(!1),t("")};return{showNotification:e=>{t(e),o(!0),setTimeout(()=>{l()},3e3)},closeNotification:l,Notification:()=>(0,r.jsx)("div",{className:"notification fixed left-0 w-full px-2 z-20 bottom-14",children:(0,r.jsxs)("div",{className:" ".concat(n&&e?"opacity-100 ":"invisible opacity-0 bottom-0"," transition-opacity duration-200 \n           max-w-3xl mx-auto bg-green-500 flex items-center justify-between px-4 py-2 text-white rounded-lg shadow-lg"),children:[e,(0,r.jsx)("button",{onClick:l,className:"ml-4 p-2 cursor-pointer bg-transparent text-white border-none",children:(0,r.jsx)("i",{className:"fas fa-times"})})]})})}},s=n(69325),u=n(93348),c=n(78174),d=n(11163);let f=e=>{document.querySelectorAll("a.catalog-item").forEach(t=>{e?(t.style.pointerEvents="none",t.style.opacity="0.5"):(t.style.pointerEvents="auto",t.style.opacity="1")})};function p(e,t){if(!e||!t)return!1;let n=e.replace(/\?.*$/,"").replace(/.*\/([^/]+)(?:\.html)?$/,"$1");return t.includes(n)}var v=()=>{let e=(0,d.useRouter)(),t=(0,s.JA)("OPEN_WRITE_QRCODE","请配置公众号二维码"),n=(0,s.JA)("OPEN_WRITE_BLOG_ID"),o=(0,s.JA)("OPEN_WRITE_NAME","请配置公众号名"),l=(0,s.JA)("OPEN_WRITE_KEYWORD","请配置公众号关键词"),i=(0,s.JA)("OPEN_WRITE_BTN_TEXT","原创不易，完成人机检测，阅读全文"),v=(0,s.JA)("OPEN_WRITE_VALIDITY_DURATION",1),_=(0,s.JA)("OPEN_WRITE_WHITE_LIST",""),w=(0,s.JA)("OPEN_WRITE_YELLOW_LIST",""),{isLoaded:E,isSignedIn:m}=(0,u.O)(),h=async()=>{try{var e;await (0,c.loadExternalResource)("https://readmore.openwrite.cn/js/readmore-2.0.js","js");let r=null===(e=window)||void 0===e?void 0:e.BTWPlugin;if(r){let e=new r;window.btw=e,e.init({qrcode:t,id:"article-wrapper",name:o,btnText:i,keyword:l,blogId:n,cookieAge:v});let a=setInterval(()=>{let e=document.getElementById("read-more-wrap"),t=document.getElementById("article-wrapper");!e&&t&&(f(!1),t.style.height="auto",clearInterval(a))},1e3);return()=>clearInterval(a)}}catch(e){console.error("OpenWrite 加载异常",e)}};return(0,a.useEffect)(()=>{let t=p(e.asPath,w),r=p(e.asPath,_);if(w&&w.length>0){if(!t){console.log("当前路径不在黄名单中，放行");return}}else if(r){console.log("当前路径在白名单中，放行");return}if(m){console.log("用户已登录，放行");return}c.isBrowser&&n&&!m&&(f(!0),document.getElementById("read-more-wrap")||h())},[E,e]),(0,r.jsx)(r.Fragment,{})},_=n(89163);let w={header:0,sub_header:1,sub_sub_header:2},E=(e,t)=>{var n;let r=function e(t,n,r){if(r||(r=[]),!t)return r;for(let i of t){var o,l,a;let t=null===(o=n.block[i])||void 0===o?void 0:o.value;if(!t)continue;let{type:s}=t;(null===(l=t.content)||void 0===l?void 0:l.length)>0?e(t.content,n,r):s.indexOf("header")>=0?r.find(e=>e.id===i)||r.push({id:i,type:s,text:(0,_.FB)(null===(a=t.properties)||void 0===a?void 0:a.title),indentLevel:w[s]}):"transclusion_reference"===s?e([t.format.transclusion_reference_pointer.id],n,r):"transclusion_container"===s&&e(t.content,n,r)}return r}(null!==(n=e.content)&&void 0!==n?n:[],t),o=[{actual:-1,effective:-1}];for(let e of r){let{indentLevel:t}=e;for(;;){let{actual:n,effective:r}=o[o.length-1];if(t>n)e.indentLevel=r+1,o.push({actual:t,effective:e.indentLevel});else if(t===n){e.indentLevel=r;break}else o.pop()}}return r},m=e=>{let t=new URL(e,c.isBrowser?window.location.origin:""),n=Object.fromEntries(t.searchParams.entries());n.password&&localStorage.setItem("password_default",n.password);let r=t.pathname,o=localStorage.getItem("password_"+r),l=localStorage.getItem("password_default");return[n.password,o,l].filter(Boolean)};var h=n(31123),g=n(88495),N=n.n(g),I=!0,O=e=>{let{post:t}=e,n=(0,d.useRouter)(),{locale:o}=(0,u.O)(),[c,f]=(0,a.useState)((null==t?void 0:t.password)&&(null==t?void 0:t.password)!==""),{showNotification:p,Notification:_}=i(),w=e=>{if(!t)return!1;let r=N()((null==t?void 0:t.slug)+e);return!!e&&r===(null==t?void 0:t.password)&&(f(!1),localStorage.setItem("password_"+n.asPath,e),p(o.COMMON.ARTICLE_UNLOCK_TIPS),!0)};(0,a.useEffect)(()=>{(null==t?void 0:t.password)&&(null==t?void 0:t.password)!==""?f(!0):f(!1);let e=m(n.asPath);if(e.length>0){for(let t of e)if(w(t))break}},[t]),(0,a.useEffect)(()=>{var e;!c&&(null==t?void 0:null===(e=t.blockMap)||void 0===e?void 0:e.block)&&(t.content=Object.keys(t.blockMap.block).filter(e=>{var n,r;return(null===(r=t.blockMap.block[e])||void 0===r?void 0:null===(n=r.value)||void 0===n?void 0:n.parent_id)===t.id}),t.toc=E(t,t.blockMap))},[n,c]),e={...e,lock:c,validPassword:w};let g=(0,s.JA)("THEME",l().THEME,e.NOTION_CONFIG);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.DynamicLayout,{theme:g,layoutName:"LayoutSlug",...e}),(null==t?void 0:t.password)&&(null==t?void 0:t.password)!==""&&!c&&(0,r.jsx)(_,{}),(0,r.jsx)(v,{})]})}},35857:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return a}});var r=n(85893),o=n(11163),l=n(58979),a=!0;t.default=e=>{var t;let n=(0,o.useRouter)();return(0,r.jsx)(l.default,{...e,msg:null==n?void 0:null===(t=n.query)||void 0===t?void 0:t.msg,title:"授权结果"})}}},function(e){e.O(0,[88495,92888,49774,40179],function(){return e(e.s=87170)}),_N_E=e.O()}]);